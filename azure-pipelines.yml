# Docker
# Build and push an image to Azure Container Registry
# https://docs.microsoft.com/azure/devops/pipelines/languages/docker

trigger:
- main

pool:
   vmImage: 'ubuntu-latest'

resources:
- repo: self

steps:
- checkout: self
- task: Docker@2
  inputs:
    containerRegistry: 'sportdeets'
    repository: 'sportsdataprovider'
    command: 'buildAndPush'
    Dockerfile: '**/Dockerfile'

# variables:
#   # Container registry service connection established during pipeline creation
#   dockerRegistryServiceConnection: '1acdd19e-31e5-4557-8874-0bae6a8db0b9'
#   imageRepository: 'sportsdataprovider'
#   containerRegistry: 'sportdeets.azurecr.io'
#   dockerfilePath: '$(Build.SourcesDirectory)/Dockerfile'
#   tag: '$(Build.BuildId)'

#   # Agent VM image name
#   vmImageName: 'ubuntu-latest'

# steps:
# - task: Docker@2
#   displayName: Build an image
#   inputs:
#     repository: $(imageName)
#     command: build
#     Dockerfile: app/Dockerfile

# stages:
# - stage: Build
#   displayName: Build and push stage
#   jobs:
#   - job: Build
#     displayName: Build
#     pool:
#       vmImage: $(vmImageName)
#     steps:
#     - task: Docker@2
#       displayName: Build and push an image to container registry
#       inputs:
#         command: buildAndPush
#         repository: $(imageRepository)
#         dockerfile: $(dockerfilePath)
#         containerRegistry: $(dockerRegistryServiceConnection)
#         tags: |
#           $(tag)
